**CPU、内存和I/O设备的速度差异是并发编程背后的核心矛盾**。为了合理利用CPU的高性能，平衡三者的速度差异，计算机做出了以下贡献：  
（1）CPU增加了缓存，以均衡与内存的速度差异；  
（2）操作系统增加了进程、线程，分时复用CPU，进而均衡CPU与I/O设备的速度差异；  
（3）编译程序优化指令执行次序，使得缓存能够得到更加合理地利用。  

**以上三条就是并发程序很多诡异问题的根源**。  

### 一.源头一：缓存导致的可见性问题
一个线程对共享变量的修改，另一个线程立即看到，我们称为**可见性**。  
在多核时代，每颗CPU都有自己的缓存，这是CPU缓存与内存的数据一致性就不容易解决了，多个线程在不同的CPU上执行，这些线程操作的是不同的CPU缓存，这时不同线程

